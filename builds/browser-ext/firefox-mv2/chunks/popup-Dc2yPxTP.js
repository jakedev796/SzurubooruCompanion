import{a as y,i as g,g as m,b as u,c as w,d as E,s as h,e as v}from"./api-DwePz4_c.js";document.addEventListener("DOMContentLoaded",async()=>{const c=await y(),r=await g();if(!c.baseUrl){window.location.href="setup.html";return}if(!r){window.location.href="login.html";return}const o=document.getElementById("baseUrl"),d=document.getElementById("save"),a=document.getElementById("msg"),s=document.getElementById("notifications"),n=document.getElementById("safetyRow");o.value=c.baseUrl,s.checked=await m();const f=await u();n.querySelectorAll(".safety-btn").forEach(t=>{const e=t;e.classList.toggle("selected",e.dataset.safety===f)}),n.addEventListener("click",async t=>{const e=t.target.closest(".safety-btn");if(!(e!=null&&e.dataset.safety))return;const i=e.dataset.safety;await w(i),n.querySelectorAll(".safety-btn").forEach(l=>{l.classList.toggle("selected",l.dataset.safety===i)})}),s.addEventListener("change",async()=>{await E(s.checked)}),d.addEventListener("click",async()=>{const t=o.value.trim().replace(/\/+$/,"");if(!t){a.textContent="Base URL is required.",a.className="msg err";return}await h({baseUrl:t});try{await v({})}catch(e){console.warn("Failed to sync preferences:",e)}a.textContent="Saved.",a.className="msg ok"})});
